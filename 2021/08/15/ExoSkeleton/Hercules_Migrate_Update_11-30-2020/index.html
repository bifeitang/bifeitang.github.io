<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Yang's Blog" href="https://bifeitang.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Yang's Blog" href="https://bifeitang.github.io/atom.xml"><link rel="alternate" type="application/json" title="Yang's Blog" href="https://bifeitang.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://bifeitang.github.io/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-30-2020/"><title>| Amor Fati = Yang's Blog</title><meta name="generator" content="Hexo 5.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline"></h1><div class="meta"><span class="item" title="Created: 2021-08-15 22:19:05"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2021-08-15T22:19:05-05:00">2021-08-15</time> </span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">Symbols count in article</span> <span>4.9k</span> <span class="text">words</span> </span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">Reading time</span> <span>4 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Amor Fati</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/0064guRzly8gtiew4rq6ij61hc0u0k2z02.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/0064guRzly8gtiewjdc90j61hc0u01fx02.jpg"></li><li class="item" data-background-image="https://cdn.jsdelivr.net/gh/bifeitang/blog-img-hosting-yang@master/background-img/wallhaven-rddgwm.72m86cshizs0.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/0064guRzly8gtiept0ntpj61400p0tg702.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/0064guRzly8gtietrtj6oj61cp0q8ah502.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/0064guRzly8gtieq8rr46j61c00u0gpv02.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="https://bifeitang.github.io/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-30-2020/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Yang Hu"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Yang's Blog"></span><div class="body md" itemprop="articleBody"><h2 id="can-communication-between-teensy-and-hercules"><a class="anchor" href="#can-communication-between-teensy-and-hercules">#</a> CAN communication between Teensy and Hercules</h2><ul><li><p><span class="exturl" data-url="aHR0cHM6Ly9jb3BwZXJoaWxsdGVjaC5jb20vYmxvZy9jb250cm9sbGVyLWFyZWEtbmV0d29yay1jYW4tcHJvdG90eXBpbmctd2l0aC10ZWVuc3ktMzEzMi8=">CAN Prototyping with Teensy 3.1/3.2</span></p><ul><li>In case of working with the CAN port, you will need a CAN transceiver in order to connect the board to a real CAN bus network. The best choice for adding a CAN transceiver, in terms of size and electrical compatibility, is the <span class="exturl" data-url="aHR0cDovL2NvcHBlcmhpbGx0ZWNoLmNvbS9jYW4tYnVzLW1pbmktYnJlYWtvdXQtYm9hcmQv">CAN Bus Mini Breakout Board</span> we offer through this website.</li><li><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201114174628529.png" alt="image-20201114174628529"></li><li><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201114174729789.png" alt="image-20201114174729789"></li></ul></li><li><p>Teensy:</p></li><li><p>Able to read data from Teensy Can bus</p><ul><li><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201114182837644.png" alt="image-20201114182837644"></p></li><li><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201114183009690.png" alt="image-20201114183009690"></p></li><li><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201114184659352.png" alt="image-20201114184659352"></p></li></ul></li><li><p>Connect Hercules to the CAN bus</p><ul><li><p>Install <span class="exturl" data-url="aHR0cHM6Ly93d3cudGkuY29tL3Rvb2wvSEFMQ09HRU4=">HalCoGen</span></p></li><li><p>Install Code Composer Studio</p></li><li><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201115005749530.png" alt="image-20201115005749530"></p></li><li><p>Configure DCAN_TX, DCAN_RX</p><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201115233805328.png" alt="image-20201115233805328"></p></li><li><p>Follow the tutorial and write code</p></li></ul></li><li><p>Figure out the DCAN1 Pin</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cudGkuY29tL2xpdC9kZi9zcHJyMzk3L3NwcnIzOTcucGRmP3RzPTE2MDU0OTYyNzEwODc=">https://www.ti.com/lit/df/sprr397/sprr397.pdf?ts=1605496271087</span></li><li><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201115234025988.png" alt="image-20201115234025988"><ul><li>I was thinking maybe the pin is multiplexed to here</li><li>But wasn't able to find corresponding CAN1</li></ul></li><li>So looks like J10 44/45 are the pin I should use. And I have solder pin connecter to it.<br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201115235233243.png" alt="image-20201115235233243"></li></ul></li><li><p>Set up CAN TX</p><ul><li><p>Code Modified in <code>HL_sys_man.c</code></p></li><li><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/* USER CODE BEGIN (0) */</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"HL_can.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"HL_system.h"</span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">/* USER CODE END */</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">/* Include Files */</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"HL_sys_common.h"</span></span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">/* USER CODE BEGIN (1) */</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">/* USER CODE END */</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">/** @fn void main(void)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>*   @brief Application main function</pre></td></tr><tr><td data-num="15"></td><td><pre>*   @note This function is empty by default.</pre></td></tr><tr><td data-num="16"></td><td><pre>*</pre></td></tr><tr><td data-num="17"></td><td><pre>*   This function is called after startup.</pre></td></tr><tr><td data-num="18"></td><td><pre>*   The user can use this function to implement the application.</pre></td></tr><tr><td data-num="19"></td><td><pre>*/</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">/* USER CODE BEGIN (2) */</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"HL_can.h"</span></span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"HL_system.h"</span></span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>uint8 tx_data<span class="token punctuation">[</span>D_SIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'X'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>uint32 <span class="token function">checkPackets</span><span class="token punctuation">(</span>uint8 <span class="token operator">*</span>src_pkg<span class="token punctuation">,</span> uint8 <span class="token operator">*</span>dst_pkg<span class="token punctuation">,</span> uint32 psize<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">/* USER CODE END */</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">/* USER CODE BEGIN (3) */</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token function">canInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token function">canTransmit</span><span class="token punctuation">(</span>canREG1<span class="token punctuation">,</span> canMESSAGE_BOX1<span class="token punctuation">,</span> tx_data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">/* USER CODE END */</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token comment">/* USER CODE BEGIN (4) */</span></pre></td></tr><tr><td data-num="45"></td><td><pre>uint32 <span class="token function">checkPackages</span><span class="token punctuation">(</span>uint8 <span class="token operator">*</span>src_pkg<span class="token punctuation">,</span> uint8 <span class="token operator">*</span>dst_pkg<span class="token punctuation">,</span> uint32 psize<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    uint32 err <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    uint32 cnt <span class="token operator">=</span> psize<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>cnt<span class="token operator">--</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>src_pkg<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token operator">*</span>dst_pkg<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>            err<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token keyword">return</span> err<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token keyword">void</span> <span class="token function">canMessageNotification</span><span class="token punctuation">(</span><span class="token class-name">canBASE_t</span> <span class="token operator">*</span>node<span class="token punctuation">,</span> uint32 messageBox<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token keyword">void</span> <span class="token function">canErrorNotification</span><span class="token punctuation">(</span><span class="token class-name">canBASE_t</span> <span class="token operator">*</span>node<span class="token punctuation">,</span> uint32 notification<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token keyword">void</span> <span class="token function">canStatusChangeNotification</span><span class="token punctuation">(</span><span class="token class-name">canBASE_t</span> <span class="token operator">*</span>node<span class="token punctuation">,</span> uint32 notification<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token comment">/* USER CODE END */</span></pre></td></tr></table></figure></li></ul><pre><code>  
- ![image-20201120224019913](C:\Users\kydn8\AppData\Roaming\Typora\typora-user-images\image-20201120224019913.png)

- ![image-20201120224129579](C:\Users\kydn8\AppData\Roaming\Typora\typora-user-images\image-20201120224129579.png)

- ![image-20201120224157852](C:\Users\kydn8\AppData\Roaming\Typora\typora-user-images\image-20201120224157852.png)

</code></pre></li><li><p>Set up CAN RX</p><ul><li><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201120234019661.png" alt="image-20201120234019661"></p></li><li><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201120234038976.png" alt="image-20201120234038976"></p></li><li><p>Code</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">canIsRxMessageArrived</span><span class="token punctuation">(</span>canREG1<span class="token punctuation">,</span> canMESSAGE_BOX2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">canGetData</span><span class="token punctuation">(</span>canREG1<span class="token punctuation">,</span> canMESSAGE_BOX2<span class="token punctuation">,</span> rx_data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">sciSend</span><span class="token punctuation">(</span>sciREG1<span class="token punctuation">,</span> D_SIZE<span class="token punctuation">,</span> rx_data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>uint32 i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> D_SIZE<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Pos[%u] received data [%u]\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> rx_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ul></li><li><p>Both</p><pre><code class="language-C">int main(void)
&#123;
    canInit();
    sciInit();

    while(1)
    &#123;
        tx_data[0]++;
        canTransmit(canREG1, canMESSAGE_BOX1, tx_data);

        while(!canIsRxMessageArrived(canREG1, canMESSAGE_BOX2));
        canGetData(canREG1, canMESSAGE_BOX2, rx_data);

        sciSend(sciREG1, D_SIZE, rx_data);
        uint32 i;

        for(i = 0; i &lt; D_SIZE; ++i)
        &#123;
            printf(&quot;Pos[%u] received data [%u]\n&quot;, i, rx_data[i]);
        &#125;
    &#125;

    return 0;
&#125;
</code></pre><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201120234921668.png" alt="image-20201120234921668"></p></li><li><p>Set up the test coverage and add a unit test badge</p></li><li><p>Next Steps</p><ul><li>Communicate</li><li>State machine for joints</li><li>Matlab Simulink real-times<ul><li>Receive and send out the message</li><li>Focus on the can receive</li><li>CAN_Not_available</li></ul></li><li><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201121111506761.png" alt="image-20201121111506761"></li></ul></li></ul><h2 id="use-matlab-simulink-with-hercules-rm57x"><a class="anchor" href="#use-matlab-simulink-with-hercules-rm57x">#</a> Use MATLAB Simulink with Hercules RM57x</h2><h3 id="set-up"><a class="anchor" href="#set-up">#</a> Set Up</h3><ul><li><p><strong>Pre-requisite</strong></p><ul><li></li></ul></li><li><p>Install Cortex-R adds-on<br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128150811124.png" alt="image-20201128150811124"></p><ul><li><p>The package toolchain may be outdated, the latest code composer version is v10, but only v5 and v6 are present.<br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128151129927.png" alt="image-20201128151129927"></p></li><li><p>Make sure the version matches<br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128151213973.png" alt="image-20201128151213973"></p></li><li><p>Looks like ccsv6 has different file structure comparing with ccsv10. So installed ccsv6.</p><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128152234251.png" alt="image-20201128152234251"><br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128161503273.png" alt="image-20201128161503273"></p><p>This works<img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128161532729.png" alt="image-20201128161532729"><br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128161816355.png" alt="image-20201128161816355"><br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128161825513.png" alt="image-20201128161825513"></p><p><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128161857315.png" alt="image-20201128161857315"><br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128161914373.png" alt="image-20201128161914373"></p></li><li></li></ul></li></ul><h3 id="run-demo-code"><a class="anchor" href="#run-demo-code">#</a> Run Demo Code</h3><ul><li>Remember to switch the directory</li></ul><p>&lt;img src=&quot;C:\Users\kydn8\AppData\Roaming\Typora\typora-user-images\image-20201128174747736.png&quot; alt=&quot;image-20201128174747736&quot; style=&quot;zoom:100%;&quot; /&gt;</p><ul><li><p>Change the directory from <em><strong>C:\Program Files\Polyspace\R2020a\bin</strong></em> to your own drive<br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128175033477.png" alt="image-20201128175033477"></p></li><li><p>Second bug is I used <code>&amp;</code> in my folder name which confused the compiler.</p></li><li><p>Eventually I am able to deploy and build<br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201128183655265.png" alt="image-20201128183655265"></p><p>But there's no command window pop up as stated in the example</p><blockquote><p>After the model launches on the hardware, a command window opens and shows that the executable is running on in the TI Hercules RM57Lx LaunchPad Development Kit. To stop the model running on the TI Hercules RM57Lx LaunchPad Development Kit, close the command window.</p></blockquote><p>I suspect it's due to the warning</p><blockquote><p>All blocks in block diagram '<span class="exturl" data-url="bWF0bGFiOm9wZW5fc3lzdGVt">arm_cortex_r_gettingstarted</span>' are either virtual or have been removed by block reduction optimization or they are inactive variants, therefore there is nothing to simulate. Note, for code generation, block reduction optimization removes all diagram branches terminating in sink blocks that do not participate in code generation. For example, To Workspace blocks and potentially their sources are removed when the <span class="exturl" data-url="bWF0bGFiOmNvbmZpZ3NldC5pbnRlcm5hbC5vcGVuKCdhcm1fY29ydGV4X3JfZ2V0dGluZ3N0YXJ0ZWQnLCdNYXRGaWxlTG9nZ2luZycpOw==">MAT-file logging</span> is off.</p><p>Component:Simulink | Category:Block diagram warning</p></blockquote><ul><li><strong>Can't connect to hardware board</strong><br><img data-src="C:%5CUsers%5Ckydn8%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201129140320119.png" alt="image-20201129140320119"><ul><li>Followed the question here <span class="exturl" data-url="aHR0cHM6Ly93d3cubWF0aHdvcmtzLmNvbS9tYXRsYWJjZW50cmFsL2Fuc3dlcnMvNjIyMzczLWVtYmVkZGVkLWNvZGVyLWZvci1hcm0tY29ydGV4LXItcHJvY2Vzc29ycy1oZXJjdWxlcy10bXM1NzBsYzQzeA==">https://www.mathworks.com/matlabcentral/answers/622373-embedded-coder-for-arm-cortex-r-processors-hercules-tms570lc43x</span></li></ul></li><li></li></ul></li></ul><h2 id="check-list"><a class="anchor" href="#check-list">#</a> Check List</h2><ul class="task-list"><li class="task-list-item"><p><input type="checkbox" id="cbx_0" disabled><label for="cbx_0">Be able to compile and upload code to the Teensy</label></p><ul><li>Clean, blink LED test</li><li><span class="exturl" data-url="aHR0cHM6Ly9oYW5nb3V0cy5nb29nbGUuY29tL18vZWxVaS9jaGF0LXJlZGlyZWN0P2F1dGh1c2VyPTEmYW1wO2Rlc3Q9aHR0cHMlM0ElMkYlMkZ3d3cuYXJkdWluby5jYyUyRmVuJTJGVHV0b3JpYWwlMkZCdWlsdEluRXhhbXBsZXMlMkZCbGluaw==">https://www.arduino.cc/en/Tutorial/BuiltInExamples/Blink</span></li><li>#define LED 13</li></ul></li><li class="task-list-item"><p><input type="checkbox" id="cbx_1" disabled><label for="cbx_1">Luu will send the CAN send/receive code</label></p></li><li class="task-list-item"><p><input type="checkbox" id="cbx_2" disabled><label for="cbx_2">CAN Analyzer, microchip</label></p></li><li class="task-list-item"><p><input type="checkbox" id="cbx_3" disabled><label for="cbx_3">After the communication between Tessny-&gt; Hercules Data</label></p><ul><li><p>Logging</p></li><li><p>Timestamp, sampling rate, every signgle frame</p></li><li><p>Will log the data into as Restful API call, Json format</p><ul><li>200 Hz, every frame, log into the Json file 0.005</li></ul></li></ul></li></ul></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2020-12-14 01:11:52" itemprop="dateModified" datetime="2020-12-14T01:11:52-06:00">2020-12-14</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Yang Hu WeChat Pay"><p>WeChat Pay</p></div><div><img data-src="/images/alipay.png" alt="Yang Hu Alipay"><p>Alipay</p></div><div><img data-src="/images/paypal.png" alt="Yang Hu PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>Yang Hu <i class="ic i-at"><em>@</em></i>Yang's Blog</li><li class="link"><strong>Post link: </strong><a href="https://bifeitang.github.io/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-30-2020/">https://bifeitang.github.io/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-30-2020/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-15-2020/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;0064guRzly8gtiepb54t4j61hc0u0afa02.jpg" title="Untitled"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>Untitled</h3></a></div><div class="item right"><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_12-5-2020/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;bifeitang&#x2F;blog-img-hosting-yang@master&#x2F;background-img&#x2F;wallhaven-281d5y.75kdd8fa6bo0.png" title="Untitled"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>Untitled</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#can-communication-between-teensy-and-hercules"><span class="toc-number">1.</span> <span class="toc-text">CAN communication between Teensy and Hercules</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#use-matlab-simulink-with-hercules-rm57x"><span class="toc-number">2.</span> <span class="toc-text">Use MATLAB Simulink with Hercules RM57x</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#set-up"><span class="toc-number">2.1.</span> <span class="toc-text">Set Up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#run-demo-code"><span class="toc-number">2.2.</span> <span class="toc-text">Run Demo Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#check-list"><span class="toc-number">3.</span> <span class="toc-text">Check List</span></a></li></ol></div><div class="related panel pjax" data-title="Related"></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Yang Hu" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Yang Hu</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">27</span> <span class="name">posts</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">categories</span></a></div><div class="item tags"><a href="/tags/"><span class="count">8</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWU=" title="https:&#x2F;&#x2F;github.com&#x2F;amehime"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9hbWVoaW1l" title="https:&#x2F;&#x2F;twitter.com&#x2F;amehime"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9ydXJpc216aw==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;rurismzk"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTEyODg2ODIz" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;12886823"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vYW1laGltZQ==" title="https:&#x2F;&#x2F;weibo.com&#x2F;amehime"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS9hbWVoaW1l" title="https:&#x2F;&#x2F;about.me&#x2F;amehime"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/aboutme/" rel="section"><i class="ic i-heart"></i>About</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-15-2020/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_12-5-2020/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/15/ExoSkeleton/StateMachine/" title="Untitled">Untitled</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_May_9th_2021/" title="Untitled">Untitled</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-15-2020/" title="Untitled">Untitled</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_02-28-2020/" title="Untitled">Untitled</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/01/Don-t-need-to-be-amazing-to-start/" title="Don&#39;t need to be amazing to start">Don't need to be amazing to start</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ExoSkeleton/" title="In Exo Skeleton">Exo Skeleton</a></div><span><a href="/2020/10/25/ExoSkeleton/Hercules_FreeRTOS_Discussion_Notes/" title="Discussion Notes">Discussion Notes</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_03-13-2021/" title="Untitled">Untitled</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ExoSkeleton/" title="In Exo Skeleton">Exo Skeleton</a></div><span><a href="/2020/10/25/ExoSkeleton/Generating%20TI%20Hercules%20MCU%20optimized%20code%20from%20Simulink/" title="Generating TI Hercules MCU optimized code from Simulink">Generating TI Hercules MCU optimized code from Simulink</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-30-2020/" title="Untitled">Untitled</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2020/10/25/first-post/" title="Eureka">Eureka</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Yang Hu @ Amor Fati</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="Symbols count total">NaNm words</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="Reading time total">NaN:aN</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/08/15/ExoSkeleton/Hercules_Migrate_Update_11-30-2020/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>